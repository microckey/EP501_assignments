
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>HW1_3b</title><meta name="generator" content="MATLAB 9.9"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2020-09-28"><meta name="DC.source" content="HW1_3b.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">Use the Gaussian elimination function to solve the same system (include scaled pivoting)</a></li><li><a href="#3">Print step by step solution (Gauss elimination) for a simple system to illustrate</a></li><li><a href="#4">Compare against built in MATLAB solution</a></li><li><a href="#5">MATLAB built-in sol. 4 det.</a></li></ul></div><pre class="codeinput"><span class="comment">% HW 1 Problem 3 (b)</span>
<span class="comment">% Use Gaussian elimination to get determinant</span>

clear
clc
close <span class="string">all</span>

load(<span class="string">'testproblem.mat'</span>)

<span class="comment">% %% random problem generator</span>
<span class="comment">% nref=100;                %system size for larger reference problem</span>
<span class="comment">% A=randn(nref,nref);    %augmented matrix containing RHS of system of equations, in practice you'd want to check conditioning...</span>
<span class="comment">% b=randn(nref,1);    %RHS</span>
</pre><h2 id="2">Use the Gaussian elimination function to solve the same system (include scaled pivoting)</h2><pre class="codeinput">[Amod,ord,nuroich,detA]=Gel(A,b);

disp(<span class="string">'Elimination with scaled pivoting on matrix:  '</span>);
disp(Amod(ord,:));
xgauss=backsub(Amod(ord,:));
disp(<span class="string">'Back substitution solution using Gaussian elimination result:  '</span>);
disp(xgauss);
</pre><pre class="codeoutput">The total number of row interchanges is:  
     6

The determinant of A is:  
  -39.4247

Elimination with scaled pivoting on matrix:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
   -0.0000         0    1.4314    1.1793   -2.4810   -0.7666   -0.1733
         0         0         0    1.8286   -2.4289    0.4258   -1.7899
         0   -0.0000         0    0.0000    1.4990    0.5853    0.7876
         0         0         0         0         0    2.7112   -2.6306
         0         0         0         0         0         0   -1.4250
         0         0         0         0         0         0         0

  Columns 8 through 9

   -0.3158    2.0375
    1.1351    0.7405
    1.6059    3.6406
    0.5231  -10.6202
   -0.0765   15.9078
   -2.7627  -24.2488
   -0.8058  -16.4214
    2.3358   18.6867

Back substitution solution using Gaussian elimination result:  
    1.0000
    2.0000
    3.0000
    4.0000
    5.0000
    6.0000
    7.0000
    8.0000

</pre><h2 id="3">Print step by step solution (Gauss elimination) for a simple system to illustrate</h2><pre class="codeinput">disp(<span class="string">'%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'</span>);
[Amodsmall,ord]=Gauss_elim(A,b,true);
disp(<span class="string">'%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%'</span>);
</pre><pre class="codeoutput">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Starting Gauss elimination from row:  
     1

Current state of matrix:  
  Columns 1 through 7

   -1.0149   -2.1321    2.1778   -0.2730   -0.7841   -0.4677   -0.2841
   -0.4711    1.1454    1.1385    1.5763   -1.8054   -0.1249   -0.0867
    0.1370   -0.6291   -2.4969   -0.4809    1.8586    1.4790   -1.4694
   -0.2919   -1.2038    0.4413    0.3275   -0.6045   -0.8608    0.1922
    0.3018   -0.2539   -1.3981    0.6647    0.1034    0.7847   -0.8223
    0.3999   -1.4286   -0.2551    0.0852    0.5632    0.3086   -0.0942
   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
   -0.1768   -0.5607    0.7477    0.3232   -0.9047   -1.0570   -0.9047

  Columns 8 through 9

   -0.2883  -10.8600
    0.3501    3.9577
   -1.8359  -17.3415
    1.0360    1.3800
    2.4245   17.1229
    0.9594    8.8013
   -0.3158    2.0375
    0.4286  -11.5312

Interchanging rows:  
     1

 and:  
     7

Current matrix state after interchange:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
   -0.4711    1.1454    1.1385    1.5763   -1.8054   -0.1249   -0.0867
    0.1370   -0.6291   -2.4969   -0.4809    1.8586    1.4790   -1.4694
   -0.2919   -1.2038    0.4413    0.3275   -0.6045   -0.8608    0.1922
    0.3018   -0.2539   -1.3981    0.6647    0.1034    0.7847   -0.8223
    0.3999   -1.4286   -0.2551    0.0852    0.5632    0.3086   -0.0942
   -1.0149   -2.1321    2.1778   -0.2730   -0.7841   -0.4677   -0.2841
   -0.1768   -0.5607    0.7477    0.3232   -0.9047   -1.0570   -0.9047

  Columns 8 through 9

   -0.3158    2.0375
    0.3501    3.9577
   -1.8359  -17.3415
    1.0360    1.3800
    2.4245   17.1229
    0.9594    8.8013
   -0.2883  -10.8600
    0.4286  -11.5312

Following elimination for row:  
     1

 matrix state:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
   -0.0000    1.1559    1.0552    1.1301   -1.8629   -0.0064   -0.2570
         0   -0.6322   -2.4727   -0.3511    1.8753    1.4445   -1.4199
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
         0   -0.2607   -1.3448    0.9506    0.1402    0.7088   -0.7132
         0   -1.4376   -0.1844    0.4640    0.6120    0.2081    0.0503
         0   -2.1093    1.9984   -1.2345   -0.9081   -0.2125   -0.6511
         0   -0.5567    0.7165    0.1557   -0.9263   -1.0125   -0.9686

  Columns 8 through 9

   -0.3158    2.0375
    0.5100    2.9256
   -1.8824  -17.0413
    1.1351    0.7405
    2.3220   17.7842
    0.8236    9.6775
    0.0564  -13.0837
    0.4887  -11.9186

Starting Gauss elimination from row:  
     2

Current state of matrix:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
   -0.0000    1.1559    1.0552    1.1301   -1.8629   -0.0064   -0.2570
         0   -0.6322   -2.4727   -0.3511    1.8753    1.4445   -1.4199
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
         0   -0.2607   -1.3448    0.9506    0.1402    0.7088   -0.7132
         0   -1.4376   -0.1844    0.4640    0.6120    0.2081    0.0503
         0   -2.1093    1.9984   -1.2345   -0.9081   -0.2125   -0.6511
         0   -0.5567    0.7165    0.1557   -0.9263   -1.0125   -0.9686

  Columns 8 through 9

   -0.3158    2.0375
    0.5100    2.9256
   -1.8824  -17.0413
    1.1351    0.7405
    2.3220   17.7842
    0.8236    9.6775
    0.0564  -13.0837
    0.4887  -11.9186

Interchanging rows:  
     2

 and:  
     4

Current matrix state after interchange:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
         0   -0.6322   -2.4727   -0.3511    1.8753    1.4445   -1.4199
   -0.0000    1.1559    1.0552    1.1301   -1.8629   -0.0064   -0.2570
         0   -0.2607   -1.3448    0.9506    0.1402    0.7088   -0.7132
         0   -1.4376   -0.1844    0.4640    0.6120    0.2081    0.0503
         0   -2.1093    1.9984   -1.2345   -0.9081   -0.2125   -0.6511
         0   -0.5567    0.7165    0.1557   -0.9263   -1.0125   -0.9686

  Columns 8 through 9

   -0.3158    2.0375
    1.1351    0.7405
   -1.8824  -17.0413
    0.5100    2.9256
    2.3220   17.7842
    0.8236    9.6775
    0.0564  -13.0837
    0.4887  -11.9186

Following elimination for row:  
     2

 matrix state:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
         0         0   -2.6784   -0.3781    2.2133    1.8603   -1.4656
   -0.0000         0    1.4314    1.1793   -2.4810   -0.7666   -0.1733
         0         0   -1.4296    0.9395    0.2796    0.8802   -0.7320
         0   -0.0000   -0.6523    0.4028    1.3807    1.1535   -0.0537
         0         0    1.3118   -1.3244    0.2197    1.1747   -0.8038
         0         0    0.5353    0.1320   -0.6287   -0.6464   -1.0089

  Columns 8 through 9

   -0.3158    2.0375
    1.1351    0.7405
   -2.4817  -17.4323
    1.6059    3.6406
    2.0748   17.6229
   -0.5393    8.7884
   -1.9433  -14.3884
   -0.0391  -12.2629

Starting Gauss elimination from row:  
     3

Current state of matrix:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
         0         0   -2.6784   -0.3781    2.2133    1.8603   -1.4656
   -0.0000         0    1.4314    1.1793   -2.4810   -0.7666   -0.1733
         0         0   -1.4296    0.9395    0.2796    0.8802   -0.7320
         0   -0.0000   -0.6523    0.4028    1.3807    1.1535   -0.0537
         0         0    1.3118   -1.3244    0.2197    1.1747   -0.8038
         0         0    0.5353    0.1320   -0.6287   -0.6464   -1.0089

  Columns 8 through 9

   -0.3158    2.0375
    1.1351    0.7405
   -2.4817  -17.4323
    1.6059    3.6406
    2.0748   17.6229
   -0.5393    8.7884
   -1.9433  -14.3884
   -0.0391  -12.2629

Interchanging rows:  
     3

 and:  
     2

Current matrix state after interchange:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
   -0.0000         0    1.4314    1.1793   -2.4810   -0.7666   -0.1733
         0         0   -2.6784   -0.3781    2.2133    1.8603   -1.4656
         0         0   -1.4296    0.9395    0.2796    0.8802   -0.7320
         0   -0.0000   -0.6523    0.4028    1.3807    1.1535   -0.0537
         0         0    1.3118   -1.3244    0.2197    1.1747   -0.8038
         0         0    0.5353    0.1320   -0.6287   -0.6464   -1.0089

  Columns 8 through 9

   -0.3158    2.0375
    1.1351    0.7405
    1.6059    3.6406
   -2.4817  -17.4323
    2.0748   17.6229
   -0.5393    8.7884
   -1.9433  -14.3884
   -0.0391  -12.2629

Following elimination for row:  
     3

 matrix state:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
   -0.0000         0    1.4314    1.1793   -2.4810   -0.7666   -0.1733
         0         0         0    1.8286   -2.4289    0.4258   -1.7899
         0         0         0    2.1174   -2.1982    0.1146   -0.9052
         0   -0.0000         0    0.9402    0.2501    0.8042   -0.1327
         0         0         0   -2.4051    2.4932    1.8773   -0.6449
         0         0         0   -0.3090    0.2990   -0.3597   -0.9441

  Columns 8 through 9

   -0.3158    2.0375
    1.1351    0.7405
    1.6059    3.6406
    0.5231  -10.6202
    3.6787   21.2589
    0.1925   10.4474
   -3.4149  -17.7245
   -0.6396  -13.6243

Starting Gauss elimination from row:  
     4

Current state of matrix:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
   -0.0000         0    1.4314    1.1793   -2.4810   -0.7666   -0.1733
         0         0         0    1.8286   -2.4289    0.4258   -1.7899
         0         0         0    2.1174   -2.1982    0.1146   -0.9052
         0   -0.0000         0    0.9402    0.2501    0.8042   -0.1327
         0         0         0   -2.4051    2.4932    1.8773   -0.6449
         0         0         0   -0.3090    0.2990   -0.3597   -0.9441

  Columns 8 through 9

   -0.3158    2.0375
    1.1351    0.7405
    1.6059    3.6406
    0.5231  -10.6202
    3.6787   21.2589
    0.1925   10.4474
   -3.4149  -17.7245
   -0.6396  -13.6243

Following elimination for row:  
     4

 matrix state:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
   -0.0000         0    1.4314    1.1793   -2.4810   -0.7666   -0.1733
         0         0         0    1.8286   -2.4289    0.4258   -1.7899
         0         0         0         0    0.6143   -0.3784    1.1674
         0   -0.0000         0    0.0000    1.4990    0.5853    0.7876
         0         0         0         0   -0.7015    2.4373   -2.9992
         0         0         0         0   -0.1114   -0.2878   -1.2465

  Columns 8 through 9

   -0.3158    2.0375
    1.1351    0.7405
    1.6059    3.6406
    0.5231  -10.6202
    3.0729   33.5563
   -0.0765   15.9078
   -2.7269  -31.6931
   -0.5512  -15.4189

Starting Gauss elimination from row:  
     5

Current state of matrix:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
   -0.0000         0    1.4314    1.1793   -2.4810   -0.7666   -0.1733
         0         0         0    1.8286   -2.4289    0.4258   -1.7899
         0         0         0         0    0.6143   -0.3784    1.1674
         0   -0.0000         0    0.0000    1.4990    0.5853    0.7876
         0         0         0         0   -0.7015    2.4373   -2.9992
         0         0         0         0   -0.1114   -0.2878   -1.2465

  Columns 8 through 9

   -0.3158    2.0375
    1.1351    0.7405
    1.6059    3.6406
    0.5231  -10.6202
    3.0729   33.5563
   -0.0765   15.9078
   -2.7269  -31.6931
   -0.5512  -15.4189

Interchanging rows:  
     5

 and:  
     6

Current matrix state after interchange:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
   -0.0000         0    1.4314    1.1793   -2.4810   -0.7666   -0.1733
         0         0         0    1.8286   -2.4289    0.4258   -1.7899
         0   -0.0000         0    0.0000    1.4990    0.5853    0.7876
         0         0         0         0    0.6143   -0.3784    1.1674
         0         0         0         0   -0.7015    2.4373   -2.9992
         0         0         0         0   -0.1114   -0.2878   -1.2465

  Columns 8 through 9

   -0.3158    2.0375
    1.1351    0.7405
    1.6059    3.6406
    0.5231  -10.6202
   -0.0765   15.9078
    3.0729   33.5563
   -2.7269  -31.6931
   -0.5512  -15.4189

Following elimination for row:  
     5

 matrix state:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
   -0.0000         0    1.4314    1.1793   -2.4810   -0.7666   -0.1733
         0         0         0    1.8286   -2.4289    0.4258   -1.7899
         0   -0.0000         0    0.0000    1.4990    0.5853    0.7876
         0         0         0         0         0   -0.6183    0.8447
         0         0         0         0         0    2.7112   -2.6306
         0         0         0         0         0   -0.2443   -1.1880

  Columns 8 through 9

   -0.3158    2.0375
    1.1351    0.7405
    1.6059    3.6406
    0.5231  -10.6202
   -0.0765   15.9078
    3.1043   27.0374
   -2.7627  -24.2488
   -0.5569  -14.2366

Starting Gauss elimination from row:  
     6

Current state of matrix:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
   -0.0000         0    1.4314    1.1793   -2.4810   -0.7666   -0.1733
         0         0         0    1.8286   -2.4289    0.4258   -1.7899
         0   -0.0000         0    0.0000    1.4990    0.5853    0.7876
         0         0         0         0         0   -0.6183    0.8447
         0         0         0         0         0    2.7112   -2.6306
         0         0         0         0         0   -0.2443   -1.1880

  Columns 8 through 9

   -0.3158    2.0375
    1.1351    0.7405
    1.6059    3.6406
    0.5231  -10.6202
   -0.0765   15.9078
    3.1043   27.0374
   -2.7627  -24.2488
   -0.5569  -14.2366

Interchanging rows:  
     5

 and:  
     1

Current matrix state after interchange:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
   -0.0000         0    1.4314    1.1793   -2.4810   -0.7666   -0.1733
         0         0         0    1.8286   -2.4289    0.4258   -1.7899
         0   -0.0000         0    0.0000    1.4990    0.5853    0.7876
         0         0         0         0         0    2.7112   -2.6306
         0         0         0         0         0   -0.6183    0.8447
         0         0         0         0         0   -0.2443   -1.1880

  Columns 8 through 9

   -0.3158    2.0375
    1.1351    0.7405
    1.6059    3.6406
    0.5231  -10.6202
   -0.0765   15.9078
   -2.7627  -24.2488
    3.1043   27.0374
   -0.5569  -14.2366

Following elimination for row:  
     6

 matrix state:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
   -0.0000         0    1.4314    1.1793   -2.4810   -0.7666   -0.1733
         0         0         0    1.8286   -2.4289    0.4258   -1.7899
         0   -0.0000         0    0.0000    1.4990    0.5853    0.7876
         0         0         0         0         0    2.7112   -2.6306
         0         0         0         0         0         0    0.2448
         0         0         0         0         0         0   -1.4250

  Columns 8 through 9

   -0.3158    2.0375
    1.1351    0.7405
    1.6059    3.6406
    0.5231  -10.6202
   -0.0765   15.9078
   -2.7627  -24.2488
    2.4743   21.5075
   -0.8058  -16.4214

Starting Gauss elimination from row:  
     7

Current state of matrix:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
   -0.0000         0    1.4314    1.1793   -2.4810   -0.7666   -0.1733
         0         0         0    1.8286   -2.4289    0.4258   -1.7899
         0   -0.0000         0    0.0000    1.4990    0.5853    0.7876
         0         0         0         0         0    2.7112   -2.6306
         0         0         0         0         0         0    0.2448
         0         0         0         0         0         0   -1.4250

  Columns 8 through 9

   -0.3158    2.0375
    1.1351    0.7405
    1.6059    3.6406
    0.5231  -10.6202
   -0.0765   15.9078
   -2.7627  -24.2488
    2.4743   21.5075
   -0.8058  -16.4214

Interchanging rows:  
     5

 and:  
     8

Current matrix state after interchange:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
   -0.0000         0    1.4314    1.1793   -2.4810   -0.7666   -0.1733
         0         0         0    1.8286   -2.4289    0.4258   -1.7899
         0   -0.0000         0    0.0000    1.4990    0.5853    0.7876
         0         0         0         0         0    2.7112   -2.6306
         0         0         0         0         0         0   -1.4250
         0         0         0         0         0         0    0.2448

  Columns 8 through 9

   -0.3158    2.0375
    1.1351    0.7405
    1.6059    3.6406
    0.5231  -10.6202
   -0.0765   15.9078
   -2.7627  -24.2488
   -0.8058  -16.4214
    2.4743   21.5075

Following elimination for row:  
     7

 matrix state:  
  Columns 1 through 7

   -0.9300   -0.0209    0.1644    0.8810    0.1136   -0.2339    0.3362
         0   -1.1973    0.3897    0.0510   -0.6402   -0.7874    0.0867
   -0.0000         0    1.4314    1.1793   -2.4810   -0.7666   -0.1733
         0         0         0    1.8286   -2.4289    0.4258   -1.7899
         0   -0.0000         0    0.0000    1.4990    0.5853    0.7876
         0         0         0         0         0    2.7112   -2.6306
         0         0         0         0         0         0   -1.4250
         0         0         0         0         0         0         0

  Columns 8 through 9

   -0.3158    2.0375
    1.1351    0.7405
    1.6059    3.6406
    0.5231  -10.6202
   -0.0765   15.9078
   -2.7627  -24.2488
   -0.8058  -16.4214
    2.3358   18.6867

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
</pre><h2 id="4">Compare against built in MATLAB solution</h2><pre class="codeinput">xmat=A\b;
disp(<span class="string">'Built-in MATLAB solution'</span>);
disp(xmat);
Errrsol = xmat - xgauss;
disp(<span class="string">'The difference is (sol for x): '</span>)
disp(Errrsol)
</pre><pre class="codeoutput">Built-in MATLAB solution
    1.0000
    2.0000
    3.0000
    4.0000
    5.0000
    6.0000
    7.0000
    8.0000

The difference is (sol for x): 
   1.0e-14 *

    0.2998
   -0.0444
    0.1332
    0.0444
   -0.1776
   -0.1776
    0.1776
   -0.1776

</pre><h2 id="5">MATLAB built-in sol. 4 det.</h2><pre class="codeinput">dmat = det(A);
disp(<span class="string">'Built-in MATLAB solution for determinant'</span>);
disp(dmat);
Errrdet = dmat - detA;
disp(<span class="string">'The difference is (determinant): '</span>)
disp(Errrdet)
</pre><pre class="codeoutput">Built-in MATLAB solution for determinant
  -39.4247

The difference is (determinant): 
     0

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020b</a><br></p></div><!--
##### SOURCE BEGIN #####
% HW 1 Problem 3 (b)
% Use Gaussian elimination to get determinant

clear
clc
close all

load('testproblem.mat')

% %% random problem generator
% nref=100;                %system size for larger reference problem
% A=randn(nref,nref);    %augmented matrix containing RHS of system of equations, in practice you'd want to check conditioning...
% b=randn(nref,1);    %RHS


%% Use the Gaussian elimination function to solve the same system (include scaled pivoting)
[Amod,ord,nuroich,detA]=Gel(A,b);

disp('Elimination with scaled pivoting on matrix:  ');
disp(Amod(ord,:));
xgauss=backsub(Amod(ord,:));
disp('Back substitution solution using Gaussian elimination result:  ');
disp(xgauss);


%% Print step by step solution (Gauss elimination) for a simple system to illustrate
disp('%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%');
[Amodsmall,ord]=Gauss_elim(A,b,true);
disp('%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%');


%% Compare against built in MATLAB solution
xmat=A\b;
disp('Built-in MATLAB solution');
disp(xmat);
Errrsol = xmat - xgauss;
disp('The difference is (sol for x): ')
disp(Errrsol)


%% MATLAB built-in sol. 4 det.
dmat = det(A);
disp('Built-in MATLAB solution for determinant');
disp(dmat);
Errrdet = dmat - detA;
disp('The difference is (determinant): ')
disp(Errrdet)
##### SOURCE END #####
--></body></html>